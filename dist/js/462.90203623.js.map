{"version":3,"file":"js/462.90203623.js","mappings":"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","sources":["webpack://saltmate-app/./src/components/admin/OrderDeliveryManagement.vue","webpack://saltmate-app/./src/components/admin/OrderDeliveryManagement.vue?fbab"],"sourcesContent":["<template>\n  <div class=\"management-container\">\n    <h3><i class=\"fas fa-truck-loading\"></i> 주문 배송 관리</h3>\n    <p>고객 주문을 확인하고 배송 상태를 업데이트합니다.</p>\n\n    <div class=\"order-list card\">\n      <h4>전체 주문 목록</h4>\n      <div v-if=\"loading\" class=\"loading-spinner\"></div>\n      <table v-else-if=\"orders.length > 0\" class=\"order-table\">\n        <thead>\n          <tr>\n            <th>주문일</th>\n            <th>주문번호</th>\n            <th>주문자</th>\n            <th>주문 상품</th>\n            <th>총 결제금액</th>\n            <th>배송 상태</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"order in orders\" :key=\"order.id\">\n            <td>{{ formatDate(order.createdAt) }}</td>\n            <td>{{ order.orderId }}</td>\n            <td>{{ order.userName }}</td>\n            <td>{{ getOrderItemsSummary(order.items) }}</td>\n            <td>{{ formatCurrency(order.totalAmount) }}</td>\n            <td>\n              <select\n                v-model=\"order.status\"\n                @change=\"updateStatus(order, $event.target.value)\"\n                class=\"status-select\"\n              >\n                <option value=\"paymentCompleted\">결제 완료</option>\n                <option value=\"preparing\">배송 준비중</option>\n                <option value=\"shipping\">배송중</option>\n                <option value=\"delivered\">배송 완료</option>\n                <option value=\"cancelled\">주문 취소</option>\n              </select>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n      <div v-else class=\"no-data\">주문 내역이 없습니다.</div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\";\nimport { db } from \"@/firebaseConfig\";\nimport {\n  collection,\n  getDocs,\n  doc,\n  updateDoc,\n  orderBy,\n  query,\n} from \"firebase/firestore\";\n\nconst orders = ref([]);\nconst loading = ref(true);\n\n// --- Helper Functions ---\nconst formatDate = (timestamp) => {\n  if (!timestamp) return \"\";\n  return timestamp.toDate().toLocaleString(\"ko-KR\");\n};\nconst formatCurrency = (value) =>\n  new Intl.NumberFormat(\"ko-KR\").format(value) + \"원\";\n\nconst getOrderItemsSummary = (items) => {\n  if (!items || items.length === 0) return \"상품 정보 없음\";\n  const firstItemName = items[0].productName || \"상품\";\n  const remainingCount = items.length - 1;\n  return remainingCount > 0\n    ? `${firstItemName} 외 ${remainingCount}건`\n    : firstItemName;\n};\n\nconst getStatusText = (status) => {\n  const statusMap = {\n    paymentCompleted: \"결제 완료\",\n    preparing: \"배송 준비중\",\n    shipping: \"배송중\",\n    delivered: \"배송 완료\",\n    cancelled: \"주문 취소\",\n  };\n  return statusMap[status] || status;\n};\n\n// --- Firestore Functions ---\nconst fetchOrders = async () => {\n  loading.value = true;\n  try {\n    const ordersRef = collection(db, \"orders\");\n    const q = query(ordersRef, orderBy(\"createdAt\", \"desc\"));\n    const querySnapshot = await getDocs(q);\n    orders.value = querySnapshot.docs.map((doc) => ({\n      id: doc.id,\n      ...doc.data(),\n    }));\n  } catch (error) {\n    console.error(\"주문 목록을 불러오는 중 오류 발생:\", error);\n    alert(\"주문 목록을 불러오는 데 실패했습니다.\");\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst updateStatus = async (order, newStatus) => {\n  const newStatusText = getStatusText(newStatus);\n  if (\n    !confirm(\n      `'${order.userName}'님의 주문 상태를 '${newStatusText}'(으)로 변경하시겠습니까?`\n    )\n  ) {\n    // 사용자가 '취소'를 누르면, select의 값을 원래대로 되돌립니다.\n    event.target.value = order.status;\n    return;\n  }\n\n  try {\n    const orderRef = doc(db, \"orders\", order.id);\n    await updateDoc(orderRef, { status: newStatus });\n    alert(\"주문 상태가 성공적으로 변경되었습니다.\");\n    // 로컬 데이터도 업데이트하여 UI에 즉시 반영\n    order.status = newStatus;\n  } catch (error) {\n    console.error(\"주문 상태 변경 중 오류 발생: \", error);\n    alert(\"주문 상태 변경에 실패했습니다.\");\n    event.target.value = order.status; // 오류 발생 시 원래 상태로 복구\n  }\n};\n\nonMounted(fetchOrders);\n</script>\n\n<style scoped>\n/* 이전 컴포넌트들과 유사한 스타일 */\n.management-container {\n  display: flex;\n  flex-direction: column;\n  gap: 30px;\n}\n.card {\n  background-color: #fff;\n  padding: 30px;\n  border-radius: 12px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);\n}\nh3,\nh4 {\n  margin-top: 0;\n}\n\n.order-table {\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 20px;\n}\n.order-table th,\n.order-table td {\n  border-bottom: 1px solid #eee;\n  padding: 12px 15px;\n  text-align: left;\n  vertical-align: middle;\n}\n.order-table th {\n  background-color: #f8f9fa;\n}\n\n/* 상태 변경 드롭다운 */\n.status-select {\n  padding: 6px 10px;\n  border-radius: 5px;\n  border: 1px solid #ccc;\n  background-color: #fff;\n  cursor: pointer;\n}\n.status-select:focus {\n  outline: none;\n  border-color: #007bff;\n  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);\n}\n\n/* 로딩 및 데이터 없음 스타일 */\n.loading-spinner,\n.no-data {\n  text-align: center;\n  padding: 50px;\n  color: #777;\n}\n.loading-spinner {\n  border: 4px solid rgba(0, 0, 0, 0.1);\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  border-left-color: #007bff;\n  animation: spin 1s ease infinite;\n  margin: 50px auto;\n}\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","import script from \"./OrderDeliveryManagement.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./OrderDeliveryManagement.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./OrderDeliveryManagement.vue?vue&type=style&index=0&id=1c2baac8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1c2baac8\"]])\n\nexport default __exports__"],"names":["orders","ref","loading","formatDate","timestamp","toDate","toLocaleString","formatCurrency","value","Intl","NumberFormat","format","getOrderItemsSummary","items","length","firstItemName","productName","remainingCount","getStatusText","status","statusMap","paymentCompleted","preparing","shipping","delivered","cancelled","fetchOrders","async","ordersRef","collection","db","q","query","orderBy","querySnapshot","getDocs","docs","map","doc","id","data","error","console","alert","updateStatus","order","newStatus","newStatusText","confirm","userName","orderRef","updateDoc","event","target","onMounted","_createElementBlock","_hoisted_1","_createElementVNode","class","_hoisted_2","_hoisted_3","_hoisted_4","_Fragment","_renderList","key","_toDisplayString","createdAt","orderId","totalAmount","$event","onChange","_hoisted_6","__exports__"],"sourceRoot":""}