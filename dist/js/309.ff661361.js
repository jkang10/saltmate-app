"use strict";(self["webpackChunksaltmate_app"]=self["webpackChunksaltmate_app"]||[]).push([[309],{309:function(t,n,l){l.r(n),l.d(n,{default:function(){return _}});l(8111),l(2489),l(1701),l(8237);var e=l(6768),a=l(4232),s=l(144),u=l(5328),c=l(2832);const o={class:"investment-management"},d={class:"summary-cards"},r={class:"card"},k={class:"card"},i={class:"card"},v={class:"card"},m={key:0,class:"loading-spinner"},L={key:1,class:"investment-table"},p={class:"amount"},h=["onClick"],C=["onClick"],b={key:2,class:"no-data"};var g={__name:"InvestmentManagement",setup(t){const n=(0,s.KR)([]),l=(0,s.KR)(!0),g=(0,s.Kh)({totalAmount:0,totalCount:0,completedCount:0,pendingCount:0}),y=t=>new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW"}).format(t),f=t=>t?t.toDate().toLocaleDateString("ko-KR"):"",_=t=>{const n={pending:"입금 확인중",completed:"처리 완료",cancelled:"취소"};return n[t]||t},E=async()=>{l.value=!0;try{const t=(0,c.rJ)(u.db,"investments"),l=(0,c.P)(t,(0,c.My)("createdAt","desc")),e=await(0,c.GG)(l);n.value=e.docs.map(t=>({id:t.id,...t.data()})),X()}catch(t){console.error("투자 내역을 불러오는 중 오류 발생:",t),alert("투자 내역을 불러오는 데 실패했습니다.")}finally{l.value=!1}},X=()=>{g.totalAmount=n.value.reduce((t,n)=>t+n.amount,0),g.totalCount=n.value.length,g.completedCount=n.value.filter(t=>"completed"===t.status).length,g.pendingCount=n.value.filter(t=>"pending"===t.status).length},K=async(t,l)=>{const e=_(l),a=confirm(`이 투자 건의 상태를 '${e}' (으)로 변경하시겠습니까?`);if(a)try{const e=(0,c.H9)(u.db,"investments",t);await(0,c.mZ)(e,{status:l});const a=n.value.findIndex(n=>n.id===t);-1!==a&&(n.value[a].status=l),X(),alert("상태가 성공적으로 변경되었습니다.")}catch(s){console.error("상태 변경 중 오류 발생: ",s),alert("상태 변경에 실패했습니다.")}};return(0,e.sV)(E),(t,s)=>((0,e.uX)(),(0,e.CE)("div",o,[s[5]||(s[5]=(0,e.Lk)("h3",null,[(0,e.Lk)("i",{class:"fas fa-hand-holding-usd"}),(0,e.eW)(" 투자금 관리")],-1)),s[6]||(s[6]=(0,e.Lk)("p",null,"전체 투자 현황을 요약하고, 입/출금 및 정산 처리를 관리합니다.",-1)),(0,e.Lk)("div",d,[(0,e.Lk)("div",r,[s[0]||(s[0]=(0,e.Lk)("h4",null,"총 투자금액",-1)),(0,e.Lk)("p",null,(0,a.v_)(y(g.totalAmount)),1)]),(0,e.Lk)("div",k,[s[1]||(s[1]=(0,e.Lk)("h4",null,"총 투자 건수",-1)),(0,e.Lk)("p",null,(0,a.v_)(g.totalCount)+" 건",1)]),(0,e.Lk)("div",i,[s[2]||(s[2]=(0,e.Lk)("h4",null,"처리 완료 건수",-1)),(0,e.Lk)("p",null,(0,a.v_)(g.completedCount)+" 건",1)]),(0,e.Lk)("div",v,[s[3]||(s[3]=(0,e.Lk)("h4",null,"입금 확인중 건수",-1)),(0,e.Lk)("p",null,(0,a.v_)(g.pendingCount)+" 건",1)])]),l.value?((0,e.uX)(),(0,e.CE)("div",m)):n.value.length>0?((0,e.uX)(),(0,e.CE)("table",L,[s[4]||(s[4]=(0,e.Lk)("thead",null,[(0,e.Lk)("tr",null,[(0,e.Lk)("th",null,"투자자 이름"),(0,e.Lk)("th",null,"이메일"),(0,e.Lk)("th",null,"투자 금액"),(0,e.Lk)("th",null,"투자일"),(0,e.Lk)("th",null,"상태"),(0,e.Lk)("th",null,"관리")])],-1)),(0,e.Lk)("tbody",null,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(n.value,t=>((0,e.uX)(),(0,e.CE)("tr",{key:t.id},[(0,e.Lk)("td",null,(0,a.v_)(t.userName),1),(0,e.Lk)("td",null,(0,a.v_)(t.userEmail),1),(0,e.Lk)("td",p,(0,a.v_)(y(t.amount)),1),(0,e.Lk)("td",null,(0,a.v_)(f(t.createdAt)),1),(0,e.Lk)("td",null,[(0,e.Lk)("span",{class:(0,a.C4)(`status-badge status-${t.status}`)},(0,a.v_)(_(t.status)),3)]),(0,e.Lk)("td",null,["pending"===t.status?((0,e.uX)(),(0,e.CE)("button",{key:0,onClick:n=>K(t.id,"completed"),class:"btn btn-sm btn-success"}," 입금 확인 ",8,h)):(0,e.Q3)("",!0),"completed"===t.status?((0,e.uX)(),(0,e.CE)("button",{key:1,onClick:n=>K(t.id,"pending"),class:"btn btn-sm btn-warning"}," 확인 취소 ",8,C)):(0,e.Q3)("",!0)])]))),128))])])):((0,e.uX)(),(0,e.CE)("div",b,"투자 내역이 없습니다."))]))}},y=l(1241);const f=(0,y.A)(g,[["__scopeId","data-v-fb3c8410"]]);var _=f}}]);
//# sourceMappingURL=309.ff661361.js.map