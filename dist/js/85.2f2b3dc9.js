"use strict";(self["webpackChunksaltmate_app"]=self["webpackChunksaltmate_app"]||[]).push([[85],{1085:function(a,e,t){t.r(e),t.d(e,{default:function(){return J}});t(8111),t(1701),t(4603),t(7566),t(8721);var l=t(6768),r=t(4232),n=t(5130),i=t(144),o=t(5328),c=t(2832),u=t(1924);const s={class:"management-container"},d={class:"product-form card"},k={class:"form-group"},p={class:"form-group"},m={class:"form-group-inline"},v={class:"form-group"},L={class:"form-group"},b={class:"form-group"},g={key:0,class:"image-preview"},f=["src"],h={key:1,class:"image-preview"},y=["src"],w={class:"form-actions"},C={type:"submit",class:"btn btn-primary"},E={class:"product-list card"},R={key:0,class:"loading-spinner"},U={key:1,class:"product-table"},_=["src"],K=["onClick"],X=["onClick"],P={key:2,class:"no-data"};var I={__name:"ProductManagement",setup(a){const e=(0,i.KR)([]),t=(0,i.KR)(!0),I=(0,i.KR)(!1),q=(0,i.KR)(null),G={id:null,name:"",description:"",price:0,stock:0,imageUrl:"",imagePath:""},J=(0,i.Kh)({...G}),O=a=>new Intl.NumberFormat("ko-KR").format(a)+"원",$=a=>a?URL.createObjectURL(a):"",A=a=>{q.value=a.target.files[0]},D=async()=>{I.value?await F():await Q()},V=a=>{I.value=!0,Object.assign(J,a),q.value=null},j=()=>{I.value=!1,Object.assign(J,G),q.value=null},x=async()=>{t.value=!0;try{const a=(0,c.P)((0,c.rJ)(o.db,"products"),(0,c.My)("createdAt","desc")),t=await(0,c.GG)(a);e.value=t.docs.map(a=>({id:a.id,...a.data()}))}catch(a){console.error("Error fetching products: ",a)}finally{t.value=!1}},Q=async()=>{if(q.value)try{const a=`products/${Date.now()}_${q.value.name}`,e=(0,u.KR)(o.IG,a);await(0,u.D)(e,q.value);const t=await(0,u.qk)(e);await(0,c.gS)((0,c.rJ)(o.db,"products"),{name:J.name,description:J.description,price:J.price,stock:J.stock,imageUrl:t,imagePath:a,createdAt:(0,c.O5)(),updatedAt:(0,c.O5)()}),alert("상품이 성공적으로 등록되었습니다."),j(),await x()}catch(a){console.error("Error creating product: ",a)}else alert("상품 이미지를 선택해주세요.")},F=async()=>{let a=J.imageUrl,e=J.imagePath;try{if(q.value){J.imagePath&&await(0,u.XR)((0,u.KR)(o.IG,J.imagePath)),e=`products/${Date.now()}_${q.value.name}`;const t=(0,u.KR)(o.IG,e);await(0,u.D)(t,q.value),a=await(0,u.qk)(t)}const t=(0,c.H9)(o.db,"products",J.id);await(0,c.mZ)(t,{name:J.name,description:J.description,price:J.price,stock:J.stock,imageUrl:a,imagePath:e,updatedAt:(0,c.O5)()}),alert("상품이 성공적으로 수정되었습니다."),j(),await x()}catch(t){console.error("Error updating product: ",t)}},H=async a=>{if(confirm(`'${a.name}' 상품을 정말로 삭제하시겠습니까?`))try{a.imagePath&&await(0,u.XR)((0,u.KR)(o.IG,a.imagePath)),await(0,c.kd)((0,c.H9)(o.db,"products",a.id)),alert("상품이 성공적으로 삭제되었습니다."),await x()}catch(e){console.error("Error deleting product: ",e)}};return(0,l.sV)(x),(a,i)=>((0,l.uX)(),(0,l.CE)("div",s,[i[12]||(i[12]=(0,l.Lk)("h3",null,[(0,l.Lk)("i",{class:"fas fa-box-open"}),(0,l.eW)(" 상품 관리")],-1)),i[13]||(i[13]=(0,l.Lk)("p",null,"상품을 등록, 수정, 삭제합니다.",-1)),(0,l.Lk)("div",d,[(0,l.Lk)("h4",null,(0,r.v_)(I.value?"상품 수정":"새 상품 등록"),1),(0,l.Lk)("form",{onSubmit:(0,n.D$)(D,["prevent"])},[(0,l.Lk)("div",k,[i[4]||(i[4]=(0,l.Lk)("label",{for:"name"},"상품명",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=a=>J.name=a),required:""},null,512),[[n.Jo,J.name]])]),(0,l.Lk)("div",p,[i[5]||(i[5]=(0,l.Lk)("label",{for:"description"},"상품 설명",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":i[1]||(i[1]=a=>J.description=a),rows:"4",required:""},null,512),[[n.Jo,J.description]])]),(0,l.Lk)("div",m,[(0,l.Lk)("div",v,[i[6]||(i[6]=(0,l.Lk)("label",{for:"price"},"가격 (원)",-1)),(0,l.bo)((0,l.Lk)("input",{type:"number","onUpdate:modelValue":i[2]||(i[2]=a=>J.price=a),required:""},null,512),[[n.Jo,J.price,void 0,{number:!0}]])]),(0,l.Lk)("div",L,[i[7]||(i[7]=(0,l.Lk)("label",{for:"stock"},"재고",-1)),(0,l.bo)((0,l.Lk)("input",{type:"number","onUpdate:modelValue":i[3]||(i[3]=a=>J.stock=a),required:""},null,512),[[n.Jo,J.stock,void 0,{number:!0}]])])]),(0,l.Lk)("div",b,[i[9]||(i[9]=(0,l.Lk)("label",{for:"image"},"상품 이미지",-1)),(0,l.Lk)("input",{type:"file",onChange:A,accept:"image/*"},null,32),!I.value&&q.value?((0,l.uX)(),(0,l.CE)("div",g,[(0,l.Lk)("img",{src:$(q.value),alt:"미리보기"},null,8,f)])):(0,l.Q3)("",!0),I.value&&J.imageUrl?((0,l.uX)(),(0,l.CE)("div",h,[i[8]||(i[8]=(0,l.Lk)("p",null,"현재 이미지:",-1)),(0,l.Lk)("img",{src:J.imageUrl,alt:"상품 이미지"},null,8,y)])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",w,[(0,l.Lk)("button",C,(0,r.v_)(I.value?"수정 완료":"상품 등록"),1),I.value?((0,l.uX)(),(0,l.CE)("button",{key:0,type:"button",onClick:j,class:"btn btn-secondary"}," 취소 ")):(0,l.Q3)("",!0)])],32)]),(0,l.Lk)("div",E,[i[11]||(i[11]=(0,l.Lk)("h4",null,"상품 목록",-1)),t.value?((0,l.uX)(),(0,l.CE)("div",R)):e.value.length>0?((0,l.uX)(),(0,l.CE)("table",U,[i[10]||(i[10]=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"이미지"),(0,l.Lk)("th",null,"상품명"),(0,l.Lk)("th",null,"가격"),(0,l.Lk)("th",null,"재고"),(0,l.Lk)("th",null,"관리")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.value,a=>((0,l.uX)(),(0,l.CE)("tr",{key:a.id},[(0,l.Lk)("td",null,[(0,l.Lk)("img",{src:a.imageUrl,alt:"상품 이미지",class:"table-img"},null,8,_)]),(0,l.Lk)("td",null,(0,r.v_)(a.name),1),(0,l.Lk)("td",null,(0,r.v_)(O(a.price)),1),(0,l.Lk)("td",null,(0,r.v_)(a.stock)+" 개",1),(0,l.Lk)("td",null,[(0,l.Lk)("button",{onClick:e=>V(a),class:"btn btn-sm btn-secondary"}," 수정 ",8,K),(0,l.Lk)("button",{onClick:e=>H(a),class:"btn btn-sm btn-danger"}," 삭제 ",8,X)])]))),128))])])):((0,l.uX)(),(0,l.CE)("div",P,"등록된 상품이 없습니다."))])]))}},q=t(1241);const G=(0,q.A)(I,[["__scopeId","data-v-70d43837"]]);var J=G}}]);
//# sourceMappingURL=85.2f2b3dc9.js.map