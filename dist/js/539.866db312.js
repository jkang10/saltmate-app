"use strict";(self["webpackChunksaltmate_app"]=self["webpackChunksaltmate_app"]||[]).push([[539],{4539:function(t,e,a){a.r(e),a.d(e,{default:function(){return _}});a(8111),a(1701);var n=a(6768),l=a(5130),r=a(4232),s=a(144),o=a(5328),d=a(2832);const i={class:"management-container"},u={class:"event-form card"},c={class:"form-group"},k={class:"form-group"},p={class:"form-group-inline"},L={class:"form-group"},m={class:"form-group"},v={class:"event-list card"},D={key:0,class:"loading-spinner"},b={key:1,class:"event-table"},f=["onClick"],h=["onClick"],g={key:2,class:"no-data"};var y={__name:"EventManagement",setup(t){const e=(0,s.KR)([]),a=(0,s.KR)(!0),y=(0,s.Kh)({title:"",description:"",startDate:"",endDate:""}),w=t=>t?t.toDate().toLocaleDateString("ko-KR"):"",C=t=>{const e=new Date,a=t.startDate.toDate(),n=t.endDate.toDate();return e<a?"upcoming":e>n?"ended":"ongoing"},_=t=>{const e={upcoming:"진행 예정",ongoing:"진행중",ended:"종료"};return e[t]||t},E=async()=>{a.value=!0;try{const t=(0,d.rJ)(o.db,"events"),a=(0,d.P)(t,(0,d.My)("startDate","desc")),n=await(0,d.GG)(a);e.value=n.docs.map(t=>({id:t.id,...t.data()}))}catch(t){console.error("이벤트 목록을 불러오는 중 오류 발생:",t)}finally{a.value=!1}},J=async()=>{if(y.title&&y.description&&y.startDate&&y.endDate)try{await(0,d.gS)((0,d.rJ)(o.db,"events"),{...y,startDate:d.Dc.fromDate(new Date(y.startDate)),endDate:d.Dc.fromDate(new Date(y.endDate)),winnerId:null,winnerName:null}),alert("이벤트가 성공적으로 생성되었습니다."),Object.assign(y,{title:"",description:"",startDate:"",endDate:""}),await E()}catch(t){console.error("이벤트 생성 중 오류 발생:",t)}else alert("모든 필드를 입력해주세요.")},X=async t=>{if(confirm("정말로 이 이벤트를 삭제하시겠습니까?"))try{await(0,d.kd)((0,d.H9)(o.db,"events",t)),alert("이벤트가 삭제되었습니다."),await E()}catch(e){console.error("이벤트 삭제 중 오류 발생:",e)}},I=async t=>{if(confirm("이벤트 당첨자를 무작위로 선정하시겠습니까?"))try{const e=await(0,d.GG)((0,d.rJ)(o.db,"users")),a=e.docs.map(t=>({id:t.id,...t.data()}));if(0===a.length)return void alert("추첨할 사용자가 없습니다.");const n=a[Math.floor(Math.random()*a.length)],l=(0,d.H9)(o.db,"events",t);await(0,d.mZ)(l,{winnerId:n.id,winnerName:n.name}),alert(`당첨자가 선정되었습니다: ${n.name}`),await E()}catch(e){console.error("당첨자 선정 중 오류 발생:",e),alert("당첨자 선정에 실패했습니다.")}};return(0,n.sV)(E),(t,s)=>((0,n.uX)(),(0,n.CE)("div",i,[s[12]||(s[12]=(0,n.Lk)("h3",null,[(0,n.Lk)("i",{class:"fas fa-calendar-alt"}),(0,n.eW)(" 이벤트 관리")],-1)),s[13]||(s[13]=(0,n.Lk)("p",null,"새로운 이벤트를 생성하고 당첨자를 관리합니다.",-1)),(0,n.Lk)("div",u,[s[9]||(s[9]=(0,n.Lk)("h4",null,"새 이벤트 생성",-1)),(0,n.Lk)("form",{onSubmit:(0,l.D$)(J,["prevent"])},[(0,n.Lk)("div",c,[s[4]||(s[4]=(0,n.Lk)("label",{for:"title"},"이벤트 제목",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":s[0]||(s[0]=t=>y.title=t),placeholder:"이벤트 제목",required:""},null,512),[[l.Jo,y.title]])]),(0,n.Lk)("div",k,[s[5]||(s[5]=(0,n.Lk)("label",{for:"description"},"이벤트 설명",-1)),(0,n.bo)((0,n.Lk)("textarea",{id:"description","onUpdate:modelValue":s[1]||(s[1]=t=>y.description=t),rows:"4",placeholder:"이벤트 상세 내용",required:""},null,512),[[l.Jo,y.description]])]),(0,n.Lk)("div",p,[(0,n.Lk)("div",L,[s[6]||(s[6]=(0,n.Lk)("label",{for:"startDate"},"시작일",-1)),(0,n.bo)((0,n.Lk)("input",{type:"date",id:"startDate","onUpdate:modelValue":s[2]||(s[2]=t=>y.startDate=t),required:""},null,512),[[l.Jo,y.startDate]])]),(0,n.Lk)("div",m,[s[7]||(s[7]=(0,n.Lk)("label",{for:"endDate"},"종료일",-1)),(0,n.bo)((0,n.Lk)("input",{type:"date",id:"endDate","onUpdate:modelValue":s[3]||(s[3]=t=>y.endDate=t),required:""},null,512),[[l.Jo,y.endDate]])])]),s[8]||(s[8]=(0,n.Lk)("button",{type:"submit",class:"btn btn-primary"},"이벤트 생성",-1))],32)]),(0,n.Lk)("div",v,[s[11]||(s[11]=(0,n.Lk)("h4",null,"이벤트 목록",-1)),a.value?((0,n.uX)(),(0,n.CE)("div",D)):e.value.length>0?((0,n.uX)(),(0,n.CE)("table",b,[s[10]||(s[10]=(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"제목"),(0,n.Lk)("th",null,"기간"),(0,n.Lk)("th",null,"상태"),(0,n.Lk)("th",null,"당첨자"),(0,n.Lk)("th",null,"관리")])],-1)),(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.value,t=>((0,n.uX)(),(0,n.CE)("tr",{key:t.id},[(0,n.Lk)("td",null,(0,r.v_)(t.title),1),(0,n.Lk)("td",null,(0,r.v_)(w(t.startDate))+" ~ "+(0,r.v_)(w(t.endDate)),1),(0,n.Lk)("td",null,[(0,n.Lk)("span",{class:(0,r.C4)(`status-badge status-${C(t)}`)},(0,r.v_)(_(C(t))),3)]),(0,n.Lk)("td",null,(0,r.v_)(t.winnerName||"미선정"),1),(0,n.Lk)("td",null,["ended"!==C(t)||t.winnerId?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("button",{key:0,onClick:e=>I(t.id),class:"btn btn-sm btn-success"}," 당첨자 선정 ",8,f)),(0,n.Lk)("button",{onClick:e=>X(t.id),class:"btn btn-sm btn-danger"}," 삭제 ",8,h)])]))),128))])])):((0,n.uX)(),(0,n.CE)("div",g,"생성된 이벤트가 없습니다."))])]))}},w=a(1241);const C=(0,w.A)(y,[["__scopeId","data-v-efaa8104"]]);var _=C}}]);
//# sourceMappingURL=539.866db312.js.map