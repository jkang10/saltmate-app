"use strict";(self["webpackChunksaltmate_app"]=self["webpackChunksaltmate_app"]||[]).push([[582],{1582:function(e,a,l){l.r(a),l.d(a,{default:function(){return N}});l(8111),l(2489),l(116),l(1701);var t=l(6768),n=l(5130),u=l(4232),s=l(144),r=l(5328),i=l(2832);const d={class:"management-container"},c={class:"nft-form card"},o={class:"form-group"},v=["value"],k={class:"nft-holders-list card"},m={key:0,class:"loading-spinner"},L={key:1,class:"holder-table"},b=["onClick"],f={key:2,class:"no-data"};var p={__name:"NFTManagement",setup(e){const a=(0,s.KR)([]),l=(0,s.KR)(!0),p=(0,s.KR)(""),F=(0,t.EW)(()=>a.value.filter(e=>e.hasNFT)),h=(0,t.EW)(()=>a.value.filter(e=>!e.hasNFT)),N=async()=>{l.value=!0;try{const e=await(0,i.GG)((0,i.rJ)(r.db,"users"));a.value=e.docs.map(e=>({id:e.id,...e.data()}))}catch(e){console.error("사용자 목록을 불러오는 중 오류 발생:",e)}finally{l.value=!1}},T=async()=>{if(!p.value)return void alert("NFT를 발행할 사용자를 선택해주세요.");const e=a.value.find(e=>e.id===p.value);if(!confirm(`'${e.name}'님에게 NFT를 발행하시겠습니까?`))return;const l=(0,i.wP)(r.db),t=(0,i.H9)(r.db,"users",p.value),n=(0,i.H9)(r.db,"equity",p.value);l.update(t,{hasNFT:!0}),l.set(n,{userId:e.id,userName:e.name,userEmail:e.email,equityPercentage:0});try{await l.commit(),alert("NFT가 성공적으로 발행되었습니다."),p.value="",await N()}catch(u){console.error("NFT 발행 중 오류 발생:",u)}},y=async e=>{if(!confirm(`'${e.name}'님의 NFT를 회수하시겠습니까? 이 작업은 해당 사용자의 지분 정보도 함께 삭제합니다.`))return;const a=(0,i.wP)(r.db),l=(0,i.H9)(r.db,"users",e.id),t=(0,i.H9)(r.db,"equity",e.id);a.update(l,{hasNFT:!1}),a.delete(t);try{await a.commit(),alert("NFT가 성공적으로 회수되었습니다."),await N()}catch(n){console.error("NFT 회수 중 오류 발생:",n)}};return(0,t.sV)(N),(e,a)=>((0,t.uX)(),(0,t.CE)("div",d,[a[7]||(a[7]=(0,t.Lk)("h3",null,[(0,t.Lk)("i",{class:"fas fa-gem"}),(0,t.eW)(" NFT 관리")],-1)),a[8]||(a[8]=(0,t.Lk)("p",null," 사용자의 공장 지분 연동 NFT 보유 현황을 관리하고, 수동으로 발행하거나 회수합니다. ",-1)),(0,t.Lk)("div",c,[a[4]||(a[4]=(0,t.Lk)("h4",null,"NFT 수동 발행",-1)),(0,t.Lk)("form",{onSubmit:(0,n.D$)(T,["prevent"])},[(0,t.Lk)("div",o,[a[2]||(a[2]=(0,t.Lk)("label",{for:"userSelect"},"대상 사용자 선택",-1)),(0,t.bo)((0,t.Lk)("select",{id:"userSelect","onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),required:""},[a[1]||(a[1]=(0,t.Lk)("option",{disabled:"",value:""},"NFT를 발행할 사용자를 선택하세요",-1)),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(h.value,e=>((0,t.uX)(),(0,t.CE)("option",{key:e.id,value:e.id},(0,u.v_)(e.name)+" ("+(0,u.v_)(e.email)+") ",9,v))),128))],512),[[n.u1,p.value]])]),a[3]||(a[3]=(0,t.Lk)("button",{type:"submit",class:"btn btn-primary"}," 선택한 사용자에게 NFT 발행 ",-1))],32)]),(0,t.Lk)("div",k,[a[6]||(a[6]=(0,t.Lk)("h4",null,"NFT 보유자 목록",-1)),l.value?((0,t.uX)(),(0,t.CE)("div",m)):F.value.length>0?((0,t.uX)(),(0,t.CE)("table",L,[a[5]||(a[5]=(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",null,"보유자 이름"),(0,t.Lk)("th",null,"이메일"),(0,t.Lk)("th",null,"지분율"),(0,t.Lk)("th",null,"관리")])],-1)),(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(F.value,e=>((0,t.uX)(),(0,t.CE)("tr",{key:e.id},[(0,t.Lk)("td",null,(0,u.v_)(e.name),1),(0,t.Lk)("td",null,(0,u.v_)(e.email),1),(0,t.Lk)("td",null,(0,u.v_)(e.equityPercentage||0)+" %",1),(0,t.Lk)("td",null,[(0,t.Lk)("button",{onClick:a=>y(e),class:"btn btn-sm btn-danger"}," NFT 회수 ",8,b)])]))),128))])])):((0,t.uX)(),(0,t.CE)("div",f,"NFT를 보유한 사용자가 없습니다."))])]))}},F=l(1241);const h=(0,F.A)(p,[["__scopeId","data-v-708018f8"]]);var N=h}}]);
//# sourceMappingURL=582.0b09906d.js.map